toster
======

Наверняка многие из вас хотели бы получить возможность ставить "минусы" на сайте toster.ru (бывший хабрахабровский Q&A). Теперь такая возможность появилась с помощью юзерскрипта, который можно найти на <a href="http://userscripts.org/scripts/show/184478">userscripts.org</a>. В ленте это выглядит так:

<img src="http://habrastorage.org/storage3/ad9/ff7/516/ad9ff7516cf5425347ea963070f6c4a2.png"/>

<h4>Установка</h4>
Скрипт устанавливается через дополнение для браузера. Для Firefox это <a href="https://addons.mozilla.org/ru/firefox/addon/greasemonkey/">Greasemonkey</a> или <a href="https://addons.mozilla.org/ru/firefox/addon/scriptish/">Scriptish</a>, для Chrome - <a href="https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo?hl=ru">Tampermonkey</a>, хотя можно и просто перетащить скачанный скрипт на страницу дополнений.

<h4>Возможности</h4>
После установки скрипта около кнопок с пальцем вверх появляется такая же, только с пальцем вниз - это и есть главный управляющий элемент. Такие кнопки присутствуют справа от заголовков тем, ответов и комментариев к ответам.

<img src="http://img-fotki.yandex.ru/get/9307/171972981.0/0_ce7bd_bfb43c71_orig"/>

Существует возможность скрытия тем, ответов и комментариев, которые набрали слишком много минусов. По умолчанию этот порог равен 100 минусам, изменить его можно на странице "Профиль". Нажимать кнопку "Сохранить" не обязательно.

<img src="http://habrastorage.org/storage3/f82/04f/db8/f8204fdb82fa4d73f86b9b390ba73384.png"/>

<h4>Принцип работы</h4>
На стороннем сервере находится MySQL база данных и php-скрипт, который служит для осуществления операций выборки количества минусов для конкретного объекта и записи информации о новом минусе. В базе только одна таблица с двумя полями, которые в паре являются индексом: IP пользователя и номер вопроса/ответа/комментария. Насколько мне известно, эти номера находятся в довольно отдаленных диапазонах (100 тыс. и 50 тыс.), так что пересечений в ближайшем будущем не предвидится.

При загрузке страницы для всех тем, ответов, и комментариев, присутствующих на странице, запрашивается количество минусов, и соответственно модифицируется DOM страницы (расставляются цифры, скрываются ненужные блоки). Иконки с пальцами вниз хранятся на том же стороннем сервере, в файле CSS, который подгружается в секцию head.

Исходный код открыт, есть репозиторий на GitHub (см. ниже). Минусы видны только тем, у кого установлен скрипт.

<h4>Ссылки</h4>
<a href="http://userscripts.org/scripts/show/184478">Страница скрипта на userscripts.org</a>
<a href="https://github.com/Pmmlabs/toster">Исходный код на GitHub</a>
